# Home Cleaning Service API

A digital marketplace platform connecting independent home cleaning professionals with customers seeking cleaning services.

## ğŸš€ Technology Stack

| Category | Technology |
|----------|------------|
| **Framework** | FastAPI |
| **Database** | MongoDB |
| **ODM** | ODMantic |
| **Async Driver** | Motor |
| **Authentication** | JWT (python-jose) |
| **Password Hashing** | Bcrypt (passlib) |
| **Server** | Uvicorn |

## ğŸ“ Project Structure

```
backend/
â”œâ”€â”€ main.py                 # Application entry point
â”œâ”€â”€ requirements.txt        # Python dependencies
â”œâ”€â”€ .env                    # Environment variables (not in git)
â”œâ”€â”€ test_api.py            # API test script
â”‚
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ apis/
â”‚       â”œâ”€â”€ api.py         # FastAPI app configuration
â”‚       â”œâ”€â”€ routers/       # API route handlers
â”‚       â”‚   â”œâ”€â”€ auth_router.py
â”‚       â”‚   â””â”€â”€ user_router.py
â”‚       â””â”€â”€ schemas/       # Pydantic models
â”‚           â”œâ”€â”€ requests/  # Request validation
â”‚           â””â”€â”€ responses/ # Response serialization
â”‚
â”œâ”€â”€ models/                 # ODMantic database models
â”‚   â””â”€â”€ user_model.py
â”‚
â”œâ”€â”€ controllers/            # Business logic layer
â”‚   â”œâ”€â”€ auth_controller.py
â”‚   â””â”€â”€ user_controller.py
â”‚
â”œâ”€â”€ cruds/                  # Database operations
â”‚   â””â”€â”€ user_crud.py
â”‚
â”œâ”€â”€ commons/                # Shared utilities
â”‚   â”œâ”€â”€ security.py        # JWT & password utilities
â”‚   â”œâ”€â”€ dependencies.py    # FastAPI dependencies
â”‚   â””â”€â”€ logger.py          # Logging configuration
â”‚
â”œâ”€â”€ database/               # MongoDB connection
â”‚   â””â”€â”€ database.py
â”‚
â””â”€â”€ logs/                   # Application logs
    â””â”€â”€ debug.log
```

## ğŸ”§ Setup & Installation

### Prerequisites
- Python 3.10+
- MongoDB (local or cloud)

### 1. Create Virtual Environment
```bash
cd backend
python -m venv venv
venv\Scripts\activate  # Windows
# source venv/bin/activate  # Linux/Mac
```

### 2. Install Dependencies
```bash
pip install -r requirements.txt
```

### 3. Configure Environment
Create a `.env` file with:
```env
# MongoDB Configuration
MONGODB_URI=mongodb://localhost:27017/home_cleaning_service
DATABASE_NAME=Home_Cleaning_Service

# JWT Configuration
JWT_SECRET_KEY=your-super-secret-key-change-in-production
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# Password Reset Token Expiry
RESET_TOKEN_EXPIRE_MINUTES=60
```

### 4. Run the Server
```bash
python -m uvicorn core.apis.api:app --host 0.0.0.0 --port 8000 --reload
```

### 5. Access API Documentation
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

## ğŸ“š API Endpoints

### Health Check
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/` | API info & docs links |
| GET | `/health` | Health check |

### Authentication (`/api/auth`)
| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| POST | `/register` | Create new account | âŒ |
| POST | `/login` | Login & get tokens | âŒ |
| POST | `/refresh` | Refresh access token | âŒ |
| POST | `/forgot-password` | Request password reset | âŒ |
| POST | `/reset-password` | Reset password with token | âŒ |
| POST | `/change-password` | Change password | âœ… |
| GET | `/me` | Get current user | âœ… |
| POST | `/verify-email` | Verify email | âŒ |
| POST | `/send-verification` | Resend verification | âœ… |

### Users (`/api/users`)
| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| GET | `/me` | Get profile | âœ… |
| PUT | `/me` | Update profile | âœ… |
| DELETE | `/me` | Delete account | âœ… |
| POST | `/me/deactivate` | Deactivate account | âœ… |
| GET | `/{user_id}` | Get public profile | âŒ |
| GET | `/` | List users | âŒ |

## ğŸ” Authentication

The API uses JWT (JSON Web Tokens) for authentication:

1. **Register** or **Login** to receive:
   - `access_token` (30 min expiry)
   - `refresh_token` (7 days expiry)

2. **Include token** in requests:
   ```
   Authorization: Bearer <access_token>
   ```

3. **Refresh** when access token expires using refresh token

## ğŸ§ª Testing

Run the API tests:
```bash
# Start server first
python -m uvicorn core.apis.api:app --port 8000

# In another terminal
python test_api.py
```

## ğŸ“‹ Development Phases

### âœ… Phase 1: Foundation & Core (COMPLETE)
- [x] Project structure setup
- [x] Database connection (MongoDB + ODMantic)
- [x] User model
- [x] Authentication schemas
- [x] Security utilities (JWT, password hashing)
- [x] User CRUD operations
- [x] Auth controller
- [x] Auth router
- [x] User controller
- [x] User router
- [x] API testing

### âœ… Phase 2: Cleaner Profiles (COMPLETE)
- [x] Cleaner profile model
- [x] Service packages model
- [x] Cleaner CRUD operations
- [x] Service CRUD operations
- [x] Cleaner search endpoints
- [x] Location-based search

### âœ… Phase 3: Booking System (COMPLETE)
- [x] Booking model
- [x] Booking workflow
- [x] Availability management
- [x] Booking status updates

### âœ… Phase 4: Reviews & Ratings (COMPLETE)
- [x] Review model
- [x] Review submission
- [x] Rating calculations

### âœ… Phase 5: Payments (COMPLETE)
- [x] Payment integration
- [x] Payment records
- [x] Payment verification
- [ ] Commission handling
- [ ] Payout processing

## ğŸ‘¤ User Roles

| Role | Capabilities |
|------|-------------|
| **Customer** | Book services, leave reviews |
| **Cleaner** | Create services, accept bookings |

## ğŸ“ License

This project is for educational purposes.

---

**Built with â¤ï¸ using FastAPI + MongoDB**
